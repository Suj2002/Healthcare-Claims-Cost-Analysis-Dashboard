<?xml version="1.0" encoding="UTF-8"?><sqlb_project><db path="healthcare1.db" readonly="0" foreign_keys="1" case_sensitive_like="0" temp_store="0" wal_autocheckpoint="1000" synchronous="2"/><attached/><window><main_tabs open="structure browser pragmas query" current="3"/></window><tab_structure><column_width id="0" width="300"/><column_width id="1" width="0"/><column_width id="2" width="100"/><column_width id="3" width="1350"/><column_width id="4" width="0"/><expanded_item id="0" parent="1"/><expanded_item id="1" parent="1"/><expanded_item id="2" parent="1"/><expanded_item id="3" parent="1"/></tab_structure><tab_browse><table title="claims_working" custom_title="0" dock_id="1" table="4,14:mainclaims_working"/><dock_state state="000000ff00000000fd00000001000000020000043c000002b4fc0100000001fb000000160064006f0063006b00420072006f007700730065003101000000000000043c0000015c00ffffff0000043c0000000000000004000000040000000800000008fc00000000"/><default_encoding codec=""/><browse_table_settings><table schema="main" name="claims_working" show_row_id="0" encoding="" plot_x_axis="" unlock_view_pk="_rowid_" freeze_columns="0"><sort/><column_widths><column index="1" value="55"/><column index="2" value="71"/><column index="3" value="72"/><column index="4" value="85"/><column index="5" value="85"/><column index="6" value="62"/><column index="7" value="70"/><column index="8" value="88"/><column index="9" value="82"/></column_widths><filter_values/><conditional_formats/><row_id_formats/><display_formats/><hidden_columns/><plot_y_axes/><global_filter/></table></browse_table_settings></tab_browse><tab_sql><sql name="SQL 1*">-- 1. Claim Type Cost Breakdown
CREATE TABLE claim_type_summary AS
SELECT claim_type,
       SUM(billed_amount) AS total_billed_amount,
       SUM(paid_amount) AS total_paid_amount,
	   COUNT(*) AS number_of_claims
FROM claims_working
GROUP BY claim_type
ORDER BY total_paid_amount DESC;

-- 2. CPT &amp; ICD Cost Drivers
CREATE TABLE CPT_cost_drivers AS
SELECT cpt_code,
       SUM(paid_amount) AS total_paid_amount
FROM claims_working
GROUP BY cpt_code
ORDER BY total_paid_amount DESC
LIMIT 10;

CREATE TABLE ICD_cost_drivers AS
SELECT icd_code,
       SUM(paid_amount) AS total_paid_amount
FROM claims_working
GROUP BY icd_code
ORDER BY total_paid_amount DESC
LIMIT 10;

CREATE TABLE CPT_avgpaid_perclaim AS
SELECT cpt_code,
       SUM(paid_amount)/COUNT(*) AS average_paid_per_claim
FROM claims_working
GROUP BY cpt_code
ORDER BY average_paid_per_claim DESC;

-- 3. Member-Level Analysis
CREATE TABLE Member_Level_amount AS
SELECT member_id,
       SUM(paid_amount) AS total_paid_amount,
       SUM(CASE WHEN claim_type = 'Emergency' THEN paid_amount END) AS Emergency_per,
	   SUM(CASE WHEN claim_type = 'Inpatient' THEN paid_amount END) AS Inpatient_per,
	   SUM(CASE WHEN claim_type = 'Lab' THEN paid_amount END) AS Lab_per,
	   SUM(CASE WHEN claim_type = 'Outpatient' THEN paid_amount END) AS Outpatient_per,
	   SUM(CASE WHEN claim_type = 'Pharmacy' THEN paid_amount END) AS Pharmacy_per
FROM claims_working
WHERE member_id IN (SELECT member_id
                    FROM claims_working
                    GROUP BY member_id
                    ORDER BY SUM(paid_amount) DESC
                    LIMIT 10)
GROUP BY member_id
ORDER BY SUM(paid_amount) DESC;

CREATE TABLE Member_Level_Pro AS
SELECT member_id,
       SUM(paid_amount) AS total_paid_amount,
       ROUND(100*SUM(CASE WHEN claim_type = 'Emergency' THEN paid_amount END)/SUM(paid_amount)) AS Emergency_per,
	   ROUND(100*SUM(CASE WHEN claim_type = 'Inpatient' THEN paid_amount END)/SUM(paid_amount)) AS Inpatient_per,
	   ROUND(100*SUM(CASE WHEN claim_type = 'Lab' THEN paid_amount END)/SUM(paid_amount)) AS Lab_per,
	   ROUND(100*SUM(CASE WHEN claim_type = 'Outpatient' THEN paid_amount END)/SUM(paid_amount)) AS Outpatient_per,
	   ROUND(100*SUM(CASE WHEN claim_type = 'Pharmacy' THEN paid_amount END)/SUM(paid_amount)) AS Pharmacy_per
FROM claims_working
WHERE member_id IN (SELECT member_id
                    FROM claims_working
                    GROUP BY member_id
                    ORDER BY SUM(paid_amount) DESC
                    LIMIT 10)
GROUP BY member_id
ORDER BY SUM(paid_amount) DESC;

--4. Billed vs Paid Ratio
-- By claim type
CREATE TABLE paid_ratio_type AS
SELECT claim_type,
       ROUND(SUM(paid_amount * 1.0)/ NULLIF(SUM(billed_amount),0),2) AS weighted_paid_ratio,
	   COUNT(*) AS claim_count
FROM claims_working
GROUP BY claim_type
ORDER BY weighted_paid_ratio ASC;

-- by provider_id
CREATE TABLE paid_ratio_provider AS
SELECT provider_id,
       ROUND(SUM(paid_amount * 1.0)/ NULLIF(SUM(billed_amount),0),2) AS weighted_paid_ratio,
	   COUNT(*) AS claim_count
FROM claims_working
GROUP BY provider_id
ORDER BY weighted_paid_ratio ASC;

-- by cpt_code
SELECT cpt_code,
       ROUND(SUM(paid_amount * 1.0)/ NULLIF(SUM(billed_amount),0),2) AS weighted_paid_ratio,
	   COUNT(*) AS claim_count
FROM claims_working
GROUP BY cpt_code
ORDER BY weighted_paid_ratio ASC;
 
</sql><current_tab id="0"/></tab_sql></sqlb_project>
